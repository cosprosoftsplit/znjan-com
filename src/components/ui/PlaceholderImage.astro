---
/**
 * PlaceholderImage â€” Beautiful CSS gradient placeholders (swap-ready for real photos).
 * When `src` is provided, renders an <img>. Otherwise, a CSS gradient <div>.
 */
interface Props {
  aspect?: '16:9' | '4:3' | '1:1' | '3:4' | '21:9';
  variant?: 'ocean' | 'sunset' | 'sand' | 'coral' | 'adriatic';
  src?: string;
  alt?: string;
  pattern?: boolean;
  credit?: string;
  class?: string;
}

const {
  aspect = '16:9',
  variant = 'ocean',
  src,
  alt = '',
  pattern = false,
  credit,
  class: className = '',
} = Astro.props;

const aspectMap: Record<string, string> = {
  '16:9': 'aspect-video',
  '4:3': 'aspect-[4/3]',
  '1:1': 'aspect-square',
  '3:4': 'aspect-[3/4]',
  '21:9': 'aspect-[21/9]',
};

const gradientMap: Record<string, string> = {
  ocean: 'linear-gradient(135deg, #0077B6 0%, #023e8a 40%, #0096c7 100%)',
  sunset: 'linear-gradient(135deg, #e07d6a 0%, #f4a261 50%, #e76f51 100%)',
  sand: 'linear-gradient(135deg, #f5ead6 0%, #d4c4a8 50%, #e9dcc9 100%)',
  coral: 'linear-gradient(135deg, #e07d6a 0%, #c1574a 50%, #e9967a 100%)',
  adriatic: 'linear-gradient(135deg, #2d8a9b 0%, #0077B6 50%, #48cae4 100%)',
};

const aspectClass = aspectMap[aspect] || aspectMap['16:9'];
const gradient = gradientMap[variant] || gradientMap['ocean'];
---

{src ? (
  <figure class:list={['relative', className]}>
    <img
      src={src}
      alt={alt}
      class:list={[aspectClass, 'w-full object-cover']}
      loading="lazy"
      decoding="async"
    />
    {credit && (
      <figcaption class="absolute bottom-0 right-0 px-2 py-1 text-[10px] text-white/70 bg-black/30 backdrop-blur-sm">
        {credit}
      </figcaption>
    )}
  </figure>
) : (
  <div
    class:list={[aspectClass, 'relative w-full overflow-hidden', className]}
    style={`background: ${gradient}`}
    role="img"
    aria-label={alt || 'Placeholder image'}
  >
    {pattern && (
      <svg class="absolute inset-0 w-full h-full opacity-10" preserveAspectRatio="none" viewBox="0 0 400 200" xmlns="http://www.w3.org/2000/svg">
        <path d="M0 100 Q50 60 100 100 T200 100 T300 100 T400 100" fill="none" stroke="white" stroke-width="2" />
        <path d="M0 130 Q50 90 100 130 T200 130 T300 130 T400 130" fill="none" stroke="white" stroke-width="1.5" />
        <path d="M0 160 Q50 120 100 160 T200 160 T300 160 T400 160" fill="none" stroke="white" stroke-width="1" />
      </svg>
    )}
  </div>
)}
