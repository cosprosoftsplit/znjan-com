---
/**
 * Instagram Embed Component
 * Embeds a public Instagram post using their official blockquote format.
 * No API key required â€” uses Instagram's embed.js for rendering.
 *
 * Usage:
 *   <InstagramEmbed url="https://www.instagram.com/p/POST_ID/" caption="Optional caption" />
 */

interface Props {
  /** Full Instagram post or reel URL */
  url: string;
  /** Optional caption to display below the embed */
  caption?: string;
  /** Max width in pixels (default: 540) */
  maxWidth?: number;
}

const { url, caption, maxWidth = 540 } = Astro.props;

// Ensure URL ends with /
const cleanUrl = url.endsWith('/') ? url : `${url}/`;
---

<div class="instagram-embed-wrapper my-6">
  <blockquote
    class="instagram-media"
    data-instgrm-permalink={cleanUrl}
    data-instgrm-version="14"
    style={`background:#FFF; border:0; border-radius:3px; box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15); margin:0 auto; max-width:${maxWidth}px; min-width:326px; padding:0; width:calc(100% - 2px);`}
  >
    <a href={cleanUrl} target="_blank" rel="noopener noreferrer" class="text-ocean-600 hover:text-ocean-800">
      View this post on Instagram
    </a>
  </blockquote>
  {caption && (
    <p class="text-sm text-stone text-center mt-2 italic">{caption}</p>
  )}
</div>
